<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 8 Making plots with ggplot2 - recap | MPS223 - Mathematics and Statistics in Action</title>
  <meta name="description" content="MPS223" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 8 Making plots with ggplot2 - recap | MPS223 - Mathematics and Statistics in Action" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="MPS223" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 8 Making plots with ggplot2 - recap | MPS223 - Mathematics and Statistics in Action" />
  
  <meta name="twitter:description" content="MPS223" />
  

<meta name="author" content="" />


<meta name="date" content="2026-02-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="missing-data.html"/>
<link rel="next" href="presentation-of-plots.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MPS223</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About these notes</a></li>
<li class="chapter" data-level="1" data-path="set-up-your-r-environment.html"><a href="set-up-your-r-environment.html"><i class="fa fa-check"></i><b>1</b> Set up your R environment</a></li>
<li class="chapter" data-level="2" data-path="project-overview.html"><a href="project-overview.html"><i class="fa fa-check"></i><b>2</b> Project overview</a></li>
<li class="part"><span><b>I Data processing</b></span></li>
<li class="chapter" data-level="3" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>3</b> Importing data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="importing-data.html"><a href="importing-data.html#importing-a-.csv-file"><i class="fa fa-check"></i><b>3.1</b> Importing a .csv file</a></li>
<li class="chapter" data-level="3.2" data-path="importing-data.html"><a href="importing-data.html#importing-excel-.xlsx-files"><i class="fa fa-check"></i><b>3.2</b> Importing Excel .xlsx files</a></li>
<li class="chapter" data-level="3.3" data-path="importing-data.html"><a href="importing-data.html#importing-a-plain-text-file"><i class="fa fa-check"></i><b>3.3</b> Importing a plain text file</a></li>
<li class="chapter" data-level="3.4" data-path="importing-data.html"><a href="importing-data.html#importing-online-data"><i class="fa fa-check"></i><b>3.4</b> Importing online data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>4</b> Strings</a>
<ul>
<li class="chapter" data-level="4.1" data-path="strings.html"><a href="strings.html#example-fictitous-exam-mark-data"><i class="fa fa-check"></i><b>4.1</b> Example: (fictitous) exam mark data</a></li>
<li class="chapter" data-level="4.2" data-path="strings.html"><a href="strings.html#importing-text-data-with-read_lines"><i class="fa fa-check"></i><b>4.2</b> Importing text data with <code>read_lines()</code></a></li>
<li class="chapter" data-level="4.3" data-path="strings.html"><a href="strings.html#finding-and-replacing-characters-in-strings"><i class="fa fa-check"></i><b>4.3</b> Finding (and replacing) characters in strings</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="strings.html"><a href="strings.html#finding-text-with-str_which"><i class="fa fa-check"></i><b>4.3.1</b> Finding text with <code>str_which()</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="strings.html"><a href="strings.html#escape-characters-and-regular-expressions"><i class="fa fa-check"></i><b>4.3.2</b> Escape characters and regular expressions</a></li>
<li class="chapter" data-level="4.3.3" data-path="strings.html"><a href="strings.html#replacing-or-removing-text"><i class="fa fa-check"></i><b>4.3.3</b> Replacing or removing text</a></li>
<li class="chapter" data-level="4.3.4" data-path="strings.html"><a href="strings.html#removing-white-space-at-startend-of-strings"><i class="fa fa-check"></i><b>4.3.4</b> Removing white space at start/end of strings</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="strings.html"><a href="strings.html#subsetting-strings"><i class="fa fa-check"></i><b>4.4</b> Subsetting strings</a></li>
<li class="chapter" data-level="4.5" data-path="strings.html"><a href="strings.html#making-a-data-frame"><i class="fa fa-check"></i><b>4.5</b> Making a data frame</a></li>
<li class="chapter" data-level="4.6" data-path="strings.html"><a href="strings.html#exercise"><i class="fa fa-check"></i><b>4.6</b> Exercise</a></li>
<li class="chapter" data-level="4.7" data-path="strings.html"><a href="strings.html#further-reading"><i class="fa fa-check"></i><b>4.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="manipulating-data-frames---recap.html"><a href="manipulating-data-frames---recap.html"><i class="fa fa-check"></i><b>5</b> Manipulating data frames - recap</a>
<ul>
<li class="chapter" data-level="5.1" data-path="manipulating-data-frames---recap.html"><a href="manipulating-data-frames---recap.html#chaining-commands-together-with-the-pipe-operator"><i class="fa fa-check"></i><b>5.1</b> Chaining commands together with the pipe operator <code>%&gt;%</code></a></li>
<li class="chapter" data-level="5.2" data-path="manipulating-data-frames---recap.html"><a href="manipulating-data-frames---recap.html#ordering-the-rows-by-a-variable-with-the-arrange-command"><i class="fa fa-check"></i><b>5.2</b> Ordering the rows by a variable with the <code>arrange()</code> command</a></li>
<li class="chapter" data-level="5.3" data-path="manipulating-data-frames---recap.html"><a href="manipulating-data-frames---recap.html#selecting-rows-with-the-filter-command"><i class="fa fa-check"></i><b>5.3</b> Selecting rows with the <code>filter()</code> command</a></li>
<li class="chapter" data-level="5.4" data-path="manipulating-data-frames---recap.html"><a href="manipulating-data-frames---recap.html#viewing-and-extracting-data-from-a-column"><i class="fa fa-check"></i><b>5.4</b> Viewing and extracting data from a column</a></li>
<li class="chapter" data-level="5.5" data-path="manipulating-data-frames---recap.html"><a href="manipulating-data-frames---recap.html#creating-new-columns-in-a-data-frame-with-the-mutate-command"><i class="fa fa-check"></i><b>5.5</b> Creating new columns in a data frame with the <code>mutate()</code> command</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summary-statistics---recap.html"><a href="summary-statistics---recap.html"><i class="fa fa-check"></i><b>6</b> Summary statistics - recap</a>
<ul>
<li class="chapter" data-level="6.1" data-path="summary-statistics---recap.html"><a href="summary-statistics---recap.html#calculating-summary-statistics-with-the-summary-command"><i class="fa fa-check"></i><b>6.1</b> Calculating summary statistics with the <code>summary()</code> command</a></li>
<li class="chapter" data-level="6.2" data-path="summary-statistics---recap.html"><a href="summary-statistics---recap.html#calculating-individual-summary-statistics"><i class="fa fa-check"></i><b>6.2</b> Calculating individual summary statistics</a></li>
<li class="chapter" data-level="6.3" data-path="summary-statistics---recap.html"><a href="summary-statistics---recap.html#computing-summaries-per-group"><i class="fa fa-check"></i><b>6.3</b> Computing summaries per group</a></li>
<li class="chapter" data-level="6.4" data-path="summary-statistics---recap.html"><a href="summary-statistics---recap.html#exercise-1"><i class="fa fa-check"></i><b>6.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>7</b> Missing data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="missing-data.html"><a href="missing-data.html#na"><i class="fa fa-check"></i><b>7.1</b> <code>NA</code></a></li>
<li class="chapter" data-level="7.2" data-path="missing-data.html"><a href="missing-data.html#functions-and-na"><i class="fa fa-check"></i><b>7.2</b> Functions and <code>NA</code></a></li>
</ul></li>
<li class="part"><span><b>II Plotting data</b></span></li>
<li class="chapter" data-level="8" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html"><i class="fa fa-check"></i><b>8</b> Making plots with <code>ggplot2</code> - recap</a>
<ul>
<li class="chapter" data-level="8.1" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#the-general-syntax"><i class="fa fa-check"></i><b>8.1</b> The general syntax</a></li>
<li class="chapter" data-level="8.2" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#scatter-plots"><i class="fa fa-check"></i><b>8.2</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#annotating-a-scatter-plot"><i class="fa fa-check"></i><b>8.2.1</b> Annotating a scatter plot</a></li>
<li class="chapter" data-level="8.2.2" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#adding-a-trend"><i class="fa fa-check"></i><b>8.2.2</b> Adding a trend</a></li>
<li class="chapter" data-level="8.2.3" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#representing-more-than-two-variables-on-a-scatter-plot"><i class="fa fa-check"></i><b>8.2.3</b> Representing more than two variables on a scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#histograms"><i class="fa fa-check"></i><b>8.3</b> Histograms</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#customising-a-histogram-plot-in-r"><i class="fa fa-check"></i><b>8.3.1</b> Customising a histogram plot in R</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#box-plots"><i class="fa fa-check"></i><b>8.4</b> Box plots</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#adding-the-observations-to-a-box-plot"><i class="fa fa-check"></i><b>8.4.1</b> Adding the observations to a box plot</a></li>
<li class="chapter" data-level="8.4.2" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#violin-plots"><i class="fa fa-check"></i><b>8.4.2</b> Violin plots</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#global-aesthetics"><i class="fa fa-check"></i><b>8.5</b> ‘Global’ aesthetics</a></li>
<li class="chapter" data-level="8.6" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#facets"><i class="fa fa-check"></i><b>8.6</b> Facets</a></li>
<li class="chapter" data-level="8.7" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#exBrexitPlots"><i class="fa fa-check"></i><b>8.7</b> Exercises</a></li>
<li class="chapter" data-level="8.8" data-path="making-plots-with-ggplot2---recap.html"><a href="making-plots-with-ggplot2---recap.html#further-reading-1"><i class="fa fa-check"></i><b>8.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html"><i class="fa fa-check"></i><b>9</b> Presentation of plots</a>
<ul>
<li class="chapter" data-level="9.1" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#the-basics"><i class="fa fa-check"></i><b>9.1</b> The basics</a></li>
<li class="chapter" data-level="9.2" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#the-caption-test"><i class="fa fa-check"></i><b>9.2</b> The caption test</a></li>
<li class="chapter" data-level="9.3" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#caption-or-title"><i class="fa fa-check"></i><b>9.3</b> Caption or title?</a></li>
<li class="chapter" data-level="9.4" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#customising-the-appearance-of-a-plot"><i class="fa fa-check"></i><b>9.4</b> Customising the appearance of a plot</a></li>
<li class="chapter" data-level="9.5" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#refining-a-plot-an-example"><i class="fa fa-check"></i><b>9.5</b> Refining a plot: an example</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#the-data-to-plot"><i class="fa fa-check"></i><b>9.5.1</b> The data to plot</a></li>
<li class="chapter" data-level="9.5.2" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#a-first-attempt-four-histograms"><i class="fa fa-check"></i><b>9.5.2</b> A first attempt: four histograms</a></li>
<li class="chapter" data-level="9.5.3" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#using-a-box-plot"><i class="fa fa-check"></i><b>9.5.3</b> Using a box plot</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#exercises"><i class="fa fa-check"></i><b>9.6</b> Exercises</a></li>
<li class="chapter" data-level="9.7" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#data-sources"><i class="fa fa-check"></i><b>9.7</b> Data sources</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html"><i class="fa fa-check"></i><b>10</b> Maps with <code>leaflet</code></a>
<ul>
<li class="chapter" data-level="10.1" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#a-basic-map"><i class="fa fa-check"></i><b>10.1</b> A basic map</a></li>
<li class="chapter" data-level="10.2" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#indicating-points-on-a-map"><i class="fa fa-check"></i><b>10.2</b> Indicating points on a map</a></li>
<li class="chapter" data-level="10.3" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#exercise-2"><i class="fa fa-check"></i><b>10.3</b> Exercise</a></li>
<li class="chapter" data-level="10.4" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#further-reading-2"><i class="fa fa-check"></i><b>10.4</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>III Statistical analysis</b></span></li>
<li class="chapter" data-level="11" data-path="computing-using-loops.html"><a href="computing-using-loops.html"><i class="fa fa-check"></i><b>11</b> Computing using loops</a>
<ul>
<li class="chapter" data-level="11.1" data-path="computing-using-loops.html"><a href="computing-using-loops.html#repeating-a-process-with-a-for-loop"><i class="fa fa-check"></i><b>11.1</b> Repeating a process with a <code>for</code> loop</a></li>
<li class="chapter" data-level="11.2" data-path="computing-using-loops.html"><a href="computing-using-loops.html#example-cleaning-two-text-files"><i class="fa fa-check"></i><b>11.2</b> Example: cleaning two text files</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="computing-using-loops.html"><a href="computing-using-loops.html#the-core-code-block"><i class="fa fa-check"></i><b>11.2.1</b> The core code block</a></li>
<li class="chapter" data-level="11.2.2" data-path="computing-using-loops.html"><a href="computing-using-loops.html#identify-the-variables-we-need-to-specify"><i class="fa fa-check"></i><b>11.2.2</b> Identify the variables we need to specify</a></li>
<li class="chapter" data-level="11.2.3" data-path="computing-using-loops.html"><a href="computing-using-loops.html#create-an-empty-list-to-store-the-results"><i class="fa fa-check"></i><b>11.2.3</b> Create an empty list to store the results</a></li>
<li class="chapter" data-level="11.2.4" data-path="computing-using-loops.html"><a href="computing-using-loops.html#use-a-for-loop-to-run-the-code-block-multiple-times"><i class="fa fa-check"></i><b>11.2.4</b> Use a for loop to run the code block multiple times</a></li>
<li class="chapter" data-level="11.2.5" data-path="computing-using-loops.html"><a href="computing-using-loops.html#convert-the-list-to-a-data-frame"><i class="fa fa-check"></i><b>11.2.5</b> Convert the list to a data frame</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="computing-using-loops.html"><a href="computing-using-loops.html#example-averaging-over-groups"><i class="fa fa-check"></i><b>11.3</b> Example: averaging over groups</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="computing-using-loops.html"><a href="computing-using-loops.html#the-core-code-block-1"><i class="fa fa-check"></i><b>11.3.1</b> The core code block</a></li>
<li class="chapter" data-level="11.3.2" data-path="computing-using-loops.html"><a href="computing-using-loops.html#identify-the-variables-we-need-to-specify-1"><i class="fa fa-check"></i><b>11.3.2</b> Identify the variables we need to specify</a></li>
<li class="chapter" data-level="11.3.3" data-path="computing-using-loops.html"><a href="computing-using-loops.html#create-an-empty-vector-to-store-the-results"><i class="fa fa-check"></i><b>11.3.3</b> Create an empty vector to store the results</a></li>
<li class="chapter" data-level="11.3.4" data-path="computing-using-loops.html"><a href="computing-using-loops.html#use-a-for-loop-to-run-the-code-block-multiple-times-1"><i class="fa fa-check"></i><b>11.3.4</b> Use a <code>for</code> loop to run the code block multiple times</a></li>
<li class="chapter" data-level="11.3.5" data-path="computing-using-loops.html"><a href="computing-using-loops.html#convert-the-vector-to-a-data-frame"><i class="fa fa-check"></i><b>11.3.5</b> Convert the vector to a data frame</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="computing-using-loops.html"><a href="computing-using-loops.html#exercise-3"><i class="fa fa-check"></i><b>11.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="relationships-in-data.html"><a href="relationships-in-data.html"><i class="fa fa-check"></i><b>12</b> Relationships in data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="relationships-in-data.html"><a href="relationships-in-data.html#covariance-and-correlation---recap"><i class="fa fa-check"></i><b>12.1</b> Covariance and correlation - recap</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="relationships-in-data.html"><a href="relationships-in-data.html#covariance"><i class="fa fa-check"></i><b>12.1.1</b> Covariance</a></li>
<li class="chapter" data-level="12.1.2" data-path="relationships-in-data.html"><a href="relationships-in-data.html#pearsons-correlation-coefficient"><i class="fa fa-check"></i><b>12.1.2</b> Pearson’s correlation coefficient</a></li>
<li class="chapter" data-level="12.1.3" data-path="relationships-in-data.html"><a href="relationships-in-data.html#spearmans-correlation-coefficient"><i class="fa fa-check"></i><b>12.1.3</b> Spearman’s correlation coefficient</a></li>
<li class="chapter" data-level="12.1.4" data-path="relationships-in-data.html"><a href="relationships-in-data.html#correlations-for-the-trees-data-set"><i class="fa fa-check"></i><b>12.1.4</b> Correlations for the <code>trees</code> data set</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="relationships-in-data.html"><a href="relationships-in-data.html#simple-linear-regression"><i class="fa fa-check"></i><b>12.2</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="relationships-in-data.html"><a href="relationships-in-data.html#fitting-the-simple-linear-regression-model-in-r"><i class="fa fa-check"></i><b>12.2.1</b> Fitting the simple linear regression model in R</a></li>
<li class="chapter" data-level="12.2.2" data-path="relationships-in-data.html"><a href="relationships-in-data.html#prediction-from-the-fitted-model"><i class="fa fa-check"></i><b>12.2.2</b> Prediction from the fitted model</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="relationships-in-data.html"><a href="relationships-in-data.html#exploring-variation-over-time"><i class="fa fa-check"></i><b>12.3</b> Exploring variation over time</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="relationships-in-data.html"><a href="relationships-in-data.html#trends"><i class="fa fa-check"></i><b>12.3.1</b> Trends</a></li>
<li class="chapter" data-level="12.3.2" data-path="relationships-in-data.html"><a href="relationships-in-data.html#seasonality"><i class="fa fa-check"></i><b>12.3.2</b> Seasonality</a></li>
<li class="chapter" data-level="12.3.3" data-path="relationships-in-data.html"><a href="relationships-in-data.html#temporal-dependence"><i class="fa fa-check"></i><b>12.3.3</b> Temporal dependence</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="relationships-in-data.html"><a href="relationships-in-data.html#exercise-4"><i class="fa fa-check"></i><b>12.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="imputing-missing-data.html"><a href="imputing-missing-data.html"><i class="fa fa-check"></i><b>13</b> Imputing missing data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="imputing-missing-data.html"><a href="imputing-missing-data.html#visualising-missing-data"><i class="fa fa-check"></i><b>13.1</b> Visualising missing data</a></li>
<li class="chapter" data-level="13.2" data-path="imputing-missing-data.html"><a href="imputing-missing-data.html#exercise-5"><i class="fa fa-check"></i><b>13.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MPS223 - Mathematics and Statistics in Action</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="making-plots-with-ggplot2---recap" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Section 8</span> Making plots with <code>ggplot2</code> - recap<a href="making-plots-with-ggplot2---recap.html#making-plots-with-ggplot2---recap" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>R has different choices available for using plots. Two commonly used options are ‘base graphics’ (e.g. using commands such as <code>plot()</code>, <code>hist()</code>, <code>boxplot()</code>) and the package <code>ggplot2</code> <span class="citation">(<a href="#ref-R-ggplot2">Wickham, Chang, et al. 2020</a>)</span>, <span class="citation">(<a href="#ref-ggplot22016">Wickham 2016</a>)</span>. It’s a matter of personal preference which you should use; I like to use both: base graphics for drawing diagrams, and <code>ggplot2</code> for plotting data from data frames. In these notes we will cover plotting with <code>ggplot2</code>.</p>
<p><img src="images/ggplot2_masterpiece.png" width="60%" style="display: block; margin: auto;" />
(Artwork by @allison_horst)</p>
<div class="rmdnote">
<p>
In this section, we’ll concentrate on how to make different types of
plots. You’ll almost certainly need to customise the appearance of your
plot, and we’ll cover that in the next section.
</p>
</div>
<p>To illustrate the different types of plots, we will continue to use <code>maths</code> data example. To try these examples out on your own computer, you’ll again need to load the <code>tidyverse</code> as well as import the <code>maths.csv</code> data and create the <code>wealthiest</code> column. The commands to do this are below.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="making-plots-with-ggplot2---recap.html#cb89-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb89-2"><a href="making-plots-with-ggplot2---recap.html#cb89-2" tabindex="-1"></a>maths <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://oakleyj.github.io/exampledata/maths.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="making-plots-with-ggplot2---recap.html#cb89-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wealthiest =</span> gdp <span class="sc">&gt;</span> <span class="dv">17000</span>)</span></code></pre></div>
<div id="the-general-syntax" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> The general syntax<a href="making-plots-with-ggplot2---recap.html#the-general-syntax" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As an example, we’ll first produce a scatter plot:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="making-plots-with-ggplot2---recap.html#cb90-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb90-2"><a href="making-plots-with-ggplot2---recap.html#cb90-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb90-3"><a href="making-plots-with-ggplot2---recap.html#cb90-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>,</span>
<span id="cb90-4"><a href="making-plots-with-ggplot2---recap.html#cb90-4" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-70-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The syntax can look a little complicated at first but you should get used to it! Some general points are as follows.</p>
<div class="rmdnote">
<p>
There is quite a lot to take in here, so just skim read for now, and
then have another look once you have seen some examples in the following
sections.
</p>
</div>
<ul>
<li>The data we want to plot must be in a data frame.</li>
<li>All plots begin with a <code>ggplot()</code> command, specifying the data frame we are using (<code>maths</code> in this case).</li>
<li>We use the <code>aes()</code> any time we want something on the plot to represent values in a data frame column, e.g
<ul>
<li>the position of a point on the <span class="math inline">\(x\)</span>-axis or <span class="math inline">\(y\)</span>-axis;</li>
<li>the colour of a point (different colours depending on variable values). This is sometimes referred to as ‘mapping a column to an aesthetic’. In the example, we mapped the <code>gdp</code> column onto the <span class="math inline">\(x\)</span>-axis, and the <code>score</code> column to the <span class="math inline">\(y\)</span>-axis.</li>
</ul></li>
<li>Any feature of the points <em>not</em> related to columns in the data frame are specified <em>outside</em> of an <code>aes()</code> command. Here we used
<ul>
<li><code>size</code> to make the points a little larger</li>
<li><code>alpha</code> to make the points transparent (helpful when points are overlapping).</li>
</ul></li>
<li>The actual type of plot is specified as a “geom”. There will be different <code>geom</code> commands for scatter plots, box plots, histograms etc. We used <code>geom_point()</code> to make a scatter plot.</li>
<li>We use the <code>+</code> symbol to combine commands and make a single plot. In the example we’ve added a command to provide axes labels.</li>
</ul>
</div>
<div id="scatter-plots" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Scatter plots<a href="making-plots-with-ggplot2---recap.html#scatter-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve seen a scatter plot already, but we’ll repeat the basic syntax here:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="making-plots-with-ggplot2---recap.html#cb91-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="making-plots-with-ggplot2---recap.html#cb91-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-72-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Note that, without the <code>labs()</code> command, the axes labels are just the column names.</p>
<div class="rmdnote">
<p>
In any report that you write, you will almost certainly need to
specify your own axes labels; the column names will not be suitable. In
your labels, include the units of measurement, if appropriate.
</p>
</div>
<div id="annotating-a-scatter-plot" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Annotating a scatter plot<a href="making-plots-with-ggplot2---recap.html#annotating-a-scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We may wish to annotate a plot, e.g. labelling a single observation. Here’s an example of labelling the UK (GDP = 39899, score = 492). We’ll also include proper axes labels.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="making-plots-with-ggplot2---recap.html#cb92-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb92-2"><a href="making-plots-with-ggplot2---recap.html#cb92-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb92-3"><a href="making-plots-with-ggplot2---recap.html#cb92-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>,</span>
<span id="cb92-4"><a href="making-plots-with-ggplot2---recap.html#cb92-4" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span></span>
<span id="cb92-5"><a href="making-plots-with-ggplot2---recap.html#cb92-5" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;point&quot;</span>, <span class="at">x =</span> <span class="dv">39899</span>, <span class="at">y =</span> <span class="dv">492</span>,</span>
<span id="cb92-6"><a href="making-plots-with-ggplot2---recap.html#cb92-6" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb92-7"><a href="making-plots-with-ggplot2---recap.html#cb92-7" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;UK&quot;</span>, <span class="at">x =</span> <span class="dv">39899</span>,</span>
<span id="cb92-8"><a href="making-plots-with-ggplot2---recap.html#cb92-8" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">492</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb92-9"><a href="making-plots-with-ggplot2---recap.html#cb92-9" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-74-1.png" width="384" style="display: block; margin: auto;" /></p>
<ul>
<li>The first <code>annotate()</code> command adds a red circle (<code>"point"</code>) at the coordinates <span class="math inline">\(x=39899\)</span>, <span class="math inline">\(y=492\)</span> (corresponding to the UK), with the <code>size</code> set to 2 to make it a little larger.</li>
<li>The second <code>annotate()</code> command adds some red text (UK) at the coordinates <span class="math inline">\(x=39899\)</span>, <span class="math inline">\(y=492\)</span>, with the arguments <code>hjust</code> and <code>vjust</code> shifting the text slightly horizontally and vertically, so that it appears next to rather than on top of the red dot. It can take a little trial and error to find the values for <code>hjust</code> and <code>vjust</code> that you are happy with.</li>
</ul>
</div>
<div id="adding-a-trend" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Adding a trend<a href="making-plots-with-ggplot2---recap.html#adding-a-trend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can see clearly that the maths scores tend to increase as GDP per capita increases, but the relationship doesn’t look linear. If we want to emphasise such a relationship, we can add the trend to the plot, using the extra line <code>geom_smooth()</code> in the plot command:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="making-plots-with-ggplot2---recap.html#cb93-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb93-2"><a href="making-plots-with-ggplot2---recap.html#cb93-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb93-3"><a href="making-plots-with-ggplot2---recap.html#cb93-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>, </span>
<span id="cb93-4"><a href="making-plots-with-ggplot2---recap.html#cb93-4" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span></span>
<span id="cb93-5"><a href="making-plots-with-ggplot2---recap.html#cb93-5" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;point&quot;</span>, <span class="at">x =</span> <span class="dv">39899</span>, </span>
<span id="cb93-6"><a href="making-plots-with-ggplot2---recap.html#cb93-6" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">492</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb93-7"><a href="making-plots-with-ggplot2---recap.html#cb93-7" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb93-8"><a href="making-plots-with-ggplot2---recap.html#cb93-8" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;UK&quot;</span>, </span>
<span id="cb93-9"><a href="making-plots-with-ggplot2---recap.html#cb93-9" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">39899</span>, <span class="at">y =</span> <span class="dv">492</span>, </span>
<span id="cb93-10"><a href="making-plots-with-ggplot2---recap.html#cb93-10" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb93-11"><a href="making-plots-with-ggplot2---recap.html#cb93-11" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb93-12"><a href="making-plots-with-ggplot2---recap.html#cb93-12" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-75-1.png" width="384" style="display: block; margin: auto;" />
The blue line shows the estimated trend. The grey shaded area indicates uncertainty about this trend (it’s wider on the right hand side, because we have less data there).</p>
<p>If we want to plot a linear trend, we add the argument <code>method = "lm"</code> to <code>geom_smooth()</code> (we can use various regression methods within <code>geom_smooth()</code>):</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="making-plots-with-ggplot2---recap.html#cb94-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths,  </span>
<span id="cb94-2"><a href="making-plots-with-ggplot2---recap.html#cb94-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb94-3"><a href="making-plots-with-ggplot2---recap.html#cb94-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb94-4"><a href="making-plots-with-ggplot2---recap.html#cb94-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb94-5"><a href="making-plots-with-ggplot2---recap.html#cb94-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Gini coeffcient&quot;</span>, </span>
<span id="cb94-6"><a href="making-plots-with-ggplot2---recap.html#cb94-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) </span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-76-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="representing-more-than-two-variables-on-a-scatter-plot" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Representing more than two variables on a scatter plot<a href="making-plots-with-ggplot2---recap.html#representing-more-than-two-variables-on-a-scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can represent a third variable using colour. Additional variables can be presented using size and shape, although care is needed here; the plot could get difficult to read.</p>
<div id="colours-for-qualitative-variables" class="section level4 hasAnchor" number="8.2.3.1">
<h4><span class="header-section-number">8.2.3.1</span> Colours for qualitative variables<a href="making-plots-with-ggplot2---recap.html#colours-for-qualitative-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here’s an example using colour to represent <code>continent</code>:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="making-plots-with-ggplot2---recap.html#cb95-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, </span>
<span id="cb95-2"><a href="making-plots-with-ggplot2---recap.html#cb95-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb95-3"><a href="making-plots-with-ggplot2---recap.html#cb95-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb95-4"><a href="making-plots-with-ggplot2---recap.html#cb95-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>, </span>
<span id="cb95-5"><a href="making-plots-with-ggplot2---recap.html#cb95-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-77-1.png" width="576" style="display: block; margin: auto;" /></p>
<ul>
<li>Note that the mapping of <code>continent</code> to <code>colour</code> has to sit inside an <code>aes()</code> command.</li>
<li>Colours can be specified manually. <code>ggplot2</code> will attempt to use distinctive colours by default, but this can be hard if there are too many groups.</li>
</ul>
</div>
<div id="colours-for-quantitative-variables" class="section level4 hasAnchor" number="8.2.3.2">
<h4><span class="header-section-number">8.2.3.2</span> Colours for quantitative variables<a href="making-plots-with-ggplot2---recap.html#colours-for-quantitative-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here’s an example using colour to represent <code>start.age</code>:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="making-plots-with-ggplot2---recap.html#cb96-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, </span>
<span id="cb96-2"><a href="making-plots-with-ggplot2---recap.html#cb96-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb96-3"><a href="making-plots-with-ggplot2---recap.html#cb96-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> start.age)) <span class="sc">+</span></span>
<span id="cb96-4"><a href="making-plots-with-ggplot2---recap.html#cb96-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>, </span>
<span id="cb96-5"><a href="making-plots-with-ggplot2---recap.html#cb96-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>,</span>
<span id="cb96-6"><a href="making-plots-with-ggplot2---recap.html#cb96-6" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;School starting age&quot;</span> )</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-78-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Note how a ‘continuous’ colour scale has been used. As there are only three distinct starting ages in the data, a ‘qualitative’ colour scale might be better here. To do this, we can convert <code>start.age</code> to a factor variable with the plot commands:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="making-plots-with-ggplot2---recap.html#cb97-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, </span>
<span id="cb97-2"><a href="making-plots-with-ggplot2---recap.html#cb97-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb97-3"><a href="making-plots-with-ggplot2---recap.html#cb97-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(start.age))) <span class="sc">+</span></span>
<span id="cb97-4"><a href="making-plots-with-ggplot2---recap.html#cb97-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>, </span>
<span id="cb97-5"><a href="making-plots-with-ggplot2---recap.html#cb97-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>,</span>
<span id="cb97-6"><a href="making-plots-with-ggplot2---recap.html#cb97-6" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;School starting age&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-79-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="histograms" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Histograms<a href="making-plots-with-ggplot2---recap.html#histograms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here’s an example of a histogram of the <code>score</code> variable. We only map one column to an axis, and produce the histogram with <code>geom_histogram()</code>:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="making-plots-with-ggplot2---recap.html#cb98-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span> </span>
<span id="cb98-2"><a href="making-plots-with-ggplot2---recap.html#cb98-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-80-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>We can scale the histogram so that the total area equals 1:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="making-plots-with-ggplot2---recap.html#cb99-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span> ..density..)) <span class="sc">+</span> </span>
<span id="cb99-2"><a href="making-plots-with-ggplot2---recap.html#cb99-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-81-1.png" width="384" style="display: block; margin: auto;" /></p>
<div id="customising-a-histogram-plot-in-r" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Customising a histogram plot in R<a href="making-plots-with-ggplot2---recap.html#customising-a-histogram-plot-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll redraw the plot with different colours, add a better axis label, specify a histogram bin-width of size 10, and indicate the UK’s score with a red dot:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="making-plots-with-ggplot2---recap.html#cb100-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span> </span>
<span id="cb100-2"><a href="making-plots-with-ggplot2---recap.html#cb100-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binwidth =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb100-3"><a href="making-plots-with-ggplot2---recap.html#cb100-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb100-4"><a href="making-plots-with-ggplot2---recap.html#cb100-4" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;point&quot;</span>, <span class="at">x =</span> <span class="dv">492</span>, <span class="at">y =</span> <span class="dv">0</span>,  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-82-1.png" width="384" style="display: block; margin: auto;" /></p>
<ul>
<li>The second line now includes extra arguments: <code>fill</code> sets the colour of the interior of the bars, and <code>colour</code> sets the colour of the bar edges. <code>binwidth</code> sets how wide each bar is on the <span class="math inline">\(x\)</span>-axis;</li>
<li>the third line (<code>labs</code>) specifies the label on the <span class="math inline">\(x\)</span>-axis;</li>
<li>the fourth line (<code>annotate</code>) draws a red circle at the coordinates <span class="math inline">\(x=492, y=0\)</span>, and <code>size = 4</code> increases the size of the circle (the default value for <code>size</code> is 1).</li>
</ul>
</div>
</div>
<div id="box-plots" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Box plots<a href="making-plots-with-ggplot2---recap.html#box-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Box plots can be useful for comparing multiple distributions, although you may need to explain to your reader how to interpret them! Here’s an example of a box plot to compare scores between the different continents:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="making-plots-with-ggplot2---recap.html#cb101-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb101-2"><a href="making-plots-with-ggplot2---recap.html#cb101-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb101-3"><a href="making-plots-with-ggplot2---recap.html#cb101-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-83-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>It can be difficult to fit all the labels in on the <span class="math inline">\(x\)</span>-axis. A simple solution is to draw the box plot ‘horizontally’ (and we’ll specify an empty <span class="math inline">\(y\)</span>-axis label as we don’t really need one).</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="making-plots-with-ggplot2---recap.html#cb102-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">y =</span> continent, <span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb102-2"><a href="making-plots-with-ggplot2---recap.html#cb102-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb102-3"><a href="making-plots-with-ggplot2---recap.html#cb102-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>,</span>
<span id="cb102-4"><a href="making-plots-with-ggplot2---recap.html#cb102-4" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>) </span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-84-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>If we wanted to do a box plot of <code>score</code> by <code>start.age</code>, we have to convert <code>start.age</code> to a factor variable using <code>as.factor()</code></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="making-plots-with-ggplot2---recap.html#cb103-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(start.age), <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb103-2"><a href="making-plots-with-ggplot2---recap.html#cb103-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb103-3"><a href="making-plots-with-ggplot2---recap.html#cb103-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;School starting age&quot;</span>, </span>
<span id="cb103-4"><a href="making-plots-with-ggplot2---recap.html#cb103-4" tabindex="-1"></a>       <span class="at">y =</span>  <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-85-1.png" width="384" style="display: block; margin: auto;" /></p>
<div id="adding-the-observations-to-a-box-plot" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Adding the observations to a box plot<a href="making-plots-with-ggplot2---recap.html#adding-the-observations-to-a-box-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It may be helpful to show the individual observations as well, for example, if the distribution of points within a group is bimodal; this wouldn’t be apparent from a box plot. It can help to ‘jitter’ the points on the group axis so that each point can be seen clearly. This can be done as follows:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="making-plots-with-ggplot2---recap.html#cb104-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(start.age), <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb104-2"><a href="making-plots-with-ggplot2---recap.html#cb104-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb104-3"><a href="making-plots-with-ggplot2---recap.html#cb104-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;School starting age&quot;</span>, </span>
<span id="cb104-4"><a href="making-plots-with-ggplot2---recap.html#cb104-4" tabindex="-1"></a>       <span class="at">y =</span>  <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span></span>
<span id="cb104-5"><a href="making-plots-with-ggplot2---recap.html#cb104-5" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-86-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="violin-plots" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Violin plots<a href="making-plots-with-ggplot2---recap.html#violin-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An alternative to a box plot is a “violin plot”, which plots (mirrored) density estimates for each group.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="making-plots-with-ggplot2---recap.html#cb105-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(start.age), <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb105-2"><a href="making-plots-with-ggplot2---recap.html#cb105-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb105-3"><a href="making-plots-with-ggplot2---recap.html#cb105-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;School starting age&quot;</span>, </span>
<span id="cb105-4"><a href="making-plots-with-ggplot2---recap.html#cb105-4" tabindex="-1"></a>       <span class="at">y =</span>  <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-87-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="global-aesthetics" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> ‘Global’ aesthetics<a href="making-plots-with-ggplot2---recap.html#global-aesthetics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Aesthetics can be defined in different places, and this affects the appearance of the plot. Here’s an example scatter plot, where we map colour to <code>wealthiest</code> within the <code>geom_point()</code> command:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="making-plots-with-ggplot2---recap.html#cb106-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, </span>
<span id="cb106-2"><a href="making-plots-with-ggplot2---recap.html#cb106-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb106-3"><a href="making-plots-with-ggplot2---recap.html#cb106-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> wealthiest)) <span class="sc">+</span></span>
<span id="cb106-4"><a href="making-plots-with-ggplot2---recap.html#cb106-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Income inequality (Gini coefficient)&quot;</span>, </span>
<span id="cb106-5"><a href="making-plots-with-ggplot2---recap.html#cb106-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span> </span>
<span id="cb106-6"><a href="making-plots-with-ggplot2---recap.html#cb106-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-88-1.png" width="576" style="display: block; margin: auto;" />
Note that the trend specified in <code>geom_smooth()</code> refers to a single trend for all the data. If we instead map <code>wealthiest</code> to colour in the <code>ggplot()</code> command, this is now applied ‘globally’ in all the subsequent <code>geom</code> commands:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="making-plots-with-ggplot2---recap.html#cb107-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, </span>
<span id="cb107-2"><a href="making-plots-with-ggplot2---recap.html#cb107-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> score, <span class="at">colour =</span> wealthiest)) <span class="sc">+</span></span>
<span id="cb107-3"><a href="making-plots-with-ggplot2---recap.html#cb107-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb107-4"><a href="making-plots-with-ggplot2---recap.html#cb107-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Income inequality (Gini coefficient)&quot;</span>, </span>
<span id="cb107-5"><a href="making-plots-with-ggplot2---recap.html#cb107-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span> </span>
<span id="cb107-6"><a href="making-plots-with-ggplot2---recap.html#cb107-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-89-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="facets" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Facets<a href="making-plots-with-ggplot2---recap.html#facets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In some cases, we may wish to create a figure with multiple plots side-by-side, or arranged in a grid. If the plots are of the same type, with the same axes, we can use <em>facets</em>, which will ensure that the scales on each axes are the same, making comparison between the plots easier.</p>
<p>For example, suppose we want a separate scatter plot of <code>score</code> against <code>gdp</code>, for each value of <code>start.age</code>. We can do this as follows:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="making-plots-with-ggplot2---recap.html#cb108-1" tabindex="-1"></a><span class="fu">ggplot</span>(maths, <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span> </span>
<span id="cb108-2"><a href="making-plots-with-ggplot2---recap.html#cb108-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb108-3"><a href="making-plots-with-ggplot2---recap.html#cb108-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(start.age))</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-90-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>See <code>?facet_grid</code> and also <code>?facet_wrap</code> for more details (look at the examples in particular, for the different ways these plots can be laid out).</p>
</div>
<div id="exBrexitPlots" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Exercises<a href="making-plots-with-ggplot2---recap.html#exBrexitPlots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="task">
<div class="exercise">
<p><span id="exr:unlabeled-div-3" class="exercise"><strong>Exercise 8.1  </strong></span>For this exercise, you will need the <code>Brexit</code> data frame (from the file <code>Brexit.csv</code>), described in Exercise 6.1.</p>
<ol style="list-style-type: decimal">
<li>Produce a scatter plot of the percentage voting to remain in the EU (within each local authority), against the percentage of adults with Level 4 qualifications.
<ul>
<li>Specify suitably descriptive axes labels;</li>
<li>add a linear trend to your plot;</li>
<li>colour each point by its <code>Region</code> variable.</li>
</ul></li>
<li>Produce a histogram showing the distribution of the percentage voting to remain in the EU across the different local authorities.
<ul>
<li>Specify a suitably descriptive axis label;</li>
<li>annotate your plot to indicate the vote in Sheffield.</li>
</ul></li>
<li>Produce a box plot for the percentage voting to remain in the EU within each region.
<ul>
<li>Experiment with ‘horizontal’ and ‘vertical’ box plots.</li>
</ul></li>
</ol>
</div>
</div>
</div>
<div id="further-reading-1" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> Further reading<a href="making-plots-with-ggplot2---recap.html#further-reading-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>There is an RStudio Cheatsheet on <code>ggplot2</code>: go to <strong>Help &gt; Cheatsheets &gt; Data Visualization with ggplot2</strong>.</p></li>
<li><p>The <a href="https://r-graphics.org/" target="_blank">R Graphics Cookbook (2nd edition)</a> is a good reference for making plots with <code>ggplot2</code>.</p></li>
<li><p>There is an online tutorial available here: <a href="https://rstudio.cloud/learn/primers/3">RStudio Primers (Visualize Data)</a></p></li>
<li><p>See also <a href="https://r4ds.had.co.nz/">R for Data Science (Chapter 3)</a></p></li>
</ul>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ggplot22016" class="csl-entry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-R-ggplot2" class="csl-entry">
Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey Dunnington. 2020. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="missing-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="presentation-of-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
