<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 18 Making plots with ggplot2 | Data handling, exploratory analysis, and reporting in R</title>
  <meta name="description" content="An introduction to R for students on MPS4110" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 18 Making plots with ggplot2 | Data handling, exploratory analysis, and reporting in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An introduction to R for students on MPS4110" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 18 Making plots with ggplot2 | Data handling, exploratory analysis, and reporting in R" />
  
  <meta name="twitter:description" content="An introduction to R for students on MPS4110" />
  

<meta name="author" content="Author: Jeremy Oakley" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="missing-data.html"/>
<link rel="next" href="presentation-of-plots.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EDA with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#about-these-notes"><i class="fa fa-check"></i><b>1.1</b> About these notes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#books"><i class="fa fa-check"></i><b>1.2</b> Books</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.3</b> Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I The basics</b></span></li>
<li class="chapter" data-level="2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> R and RStudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#starting-rstudio-on-the-university-network"><i class="fa fa-check"></i><b>2.1</b> Starting RStudio on the university network</a></li>
<li class="chapter" data-level="2.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#the-rstudio-interface"><i class="fa fa-check"></i><b>2.2</b> The RStudio interface</a></li>
<li class="chapter" data-level="2.3" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#inputs-and-outputs"><i class="fa fa-check"></i><b>2.3</b> Inputs and outputs</a></li>
<li class="chapter" data-level="2.4" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#get-comfortable"><i class="fa fa-check"></i><b>2.4</b> Get comfortable!</a></li>
<li class="chapter" data-level="2.5" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#change-your-workspace-settings"><i class="fa fa-check"></i><b>2.5</b> Change your Workspace settings</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="using-r-as-a-calculator.html"><a href="using-r-as-a-calculator.html"><i class="fa fa-check"></i><b>3</b> Using R as a calculator</a>
<ul>
<li class="chapter" data-level="3.1" data-path="using-r-as-a-calculator.html"><a href="using-r-as-a-calculator.html#scientific-notation"><i class="fa fa-check"></i><b>3.1</b> Scientific notation</a></li>
<li class="chapter" data-level="3.2" data-path="using-r-as-a-calculator.html"><a href="using-r-as-a-calculator.html#order-of-operations"><i class="fa fa-check"></i><b>3.2</b> Order of operations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html"><i class="fa fa-check"></i><b>4</b> Variables and vectors</a>
<ul>
<li class="chapter" data-level="4.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#sequences-of-integers"><i class="fa fa-check"></i><b>4.1.1</b> Sequences of integers</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#subsetting-vectors"><i class="fa fa-check"></i><b>4.2</b> Subsetting vectors</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#logical-subsetting"><i class="fa fa-check"></i><b>4.2.1</b> Logical subsetting</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#character-strings"><i class="fa fa-check"></i><b>4.3</b> Character strings</a></li>
<li class="chapter" data-level="4.4" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#factors"><i class="fa fa-check"></i><b>4.4</b> Factors</a></li>
<li class="chapter" data-level="4.5" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#the-environment-window"><i class="fa fa-check"></i><b>4.5</b> The Environment window</a></li>
<li class="chapter" data-level="4.6" data-path="variables-and-vectors.html"><a href="variables-and-vectors.html#further-reading"><i class="fa fa-check"></i><b>4.6</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>5</b> Functions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functions.html"><a href="functions.html#introducing-functions"><i class="fa fa-check"></i><b>5.1</b> Introducing functions</a></li>
<li class="chapter" data-level="5.2" data-path="functions.html"><a href="functions.html#arguments"><i class="fa fa-check"></i><b>5.2</b> Arguments</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="functions.html"><a href="functions.html#experiment"><i class="fa fa-check"></i><b>5.2.1</b> Experiment!</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="functions.html"><a href="functions.html#help-files"><i class="fa fa-check"></i><b>5.3</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-frames-tibbles-and-lists.html"><a href="data-frames-tibbles-and-lists.html"><i class="fa fa-check"></i><b>6</b> Data frames, tibbles and lists</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-frames-tibbles-and-lists.html"><a href="data-frames-tibbles-and-lists.html#data-frames"><i class="fa fa-check"></i><b>6.1</b> Data frames</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-frames-tibbles-and-lists.html"><a href="data-frames-tibbles-and-lists.html#making-data-frames"><i class="fa fa-check"></i><b>6.1.1</b> Making data frames</a></li>
<li class="chapter" data-level="6.1.2" data-path="data-frames-tibbles-and-lists.html"><a href="data-frames-tibbles-and-lists.html#extracting-rows-and-columns"><i class="fa fa-check"></i><b>6.1.2</b> Extracting rows and columns</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-frames-tibbles-and-lists.html"><a href="data-frames-tibbles-and-lists.html#tibbles"><i class="fa fa-check"></i><b>6.2</b> tibbles</a></li>
<li class="chapter" data-level="6.3" data-path="data-frames-tibbles-and-lists.html"><a href="data-frames-tibbles-and-lists.html#inspecting-large-data-frames-and-tibbles"><i class="fa fa-check"></i><b>6.3</b> Inspecting large data frames and tibbles</a></li>
<li class="chapter" data-level="6.4" data-path="data-frames-tibbles-and-lists.html"><a href="data-frames-tibbles-and-lists.html#lists"><i class="fa fa-check"></i><b>6.4</b> Lists</a></li>
<li class="chapter" data-level="6.5" data-path="data-frames-tibbles-and-lists.html"><a href="data-frames-tibbles-and-lists.html#further-reading-1"><i class="fa fa-check"></i><b>6.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="scripts.html"><a href="scripts.html"><i class="fa fa-check"></i><b>7</b> Scripts</a>
<ul>
<li class="chapter" data-level="7.1" data-path="scripts.html"><a href="scripts.html#creating-a-new-script"><i class="fa fa-check"></i><b>7.1</b> Creating a new script</a></li>
<li class="chapter" data-level="7.2" data-path="scripts.html"><a href="scripts.html#entering-and-running-commands"><i class="fa fa-check"></i><b>7.2</b> Entering and running commands</a></li>
<li class="chapter" data-level="7.3" data-path="scripts.html"><a href="scripts.html#adding-comments-and-sections-in-scripts"><i class="fa fa-check"></i><b>7.3</b> Adding comments and sections in scripts</a></li>
<li class="chapter" data-level="7.4" data-path="scripts.html"><a href="scripts.html#line-breaks-in-scripts"><i class="fa fa-check"></i><b>7.4</b> Line breaks in scripts</a></li>
<li class="chapter" data-level="7.5" data-path="scripts.html"><a href="scripts.html#saving-a-script"><i class="fa fa-check"></i><b>7.5</b> Saving a script</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="a-tip-for-understanding-r-code.html"><a href="a-tip-for-understanding-r-code.html"><i class="fa fa-check"></i><b>8</b> A tip for understanding R code</a></li>
<li class="chapter" data-level="9" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>9</b> Packages</a>
<ul>
<li class="chapter" data-level="9.1" data-path="packages.html"><a href="packages.html#installing-a-package"><i class="fa fa-check"></i><b>9.1</b> Installing a package</a></li>
<li class="chapter" data-level="9.2" data-path="packages.html"><a href="packages.html#updating-packages"><i class="fa fa-check"></i><b>9.2</b> Updating packages</a></li>
<li class="chapter" data-level="9.3" data-path="packages.html"><a href="packages.html#using-packages"><i class="fa fa-check"></i><b>9.3</b> Using packages</a></li>
<li class="chapter" data-level="9.4" data-path="packages.html"><a href="packages.html#is-there-a-package-for"><i class="fa fa-check"></i><b>9.4</b> Is there a package for…?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rstudio-projects.html"><a href="rstudio-projects.html"><i class="fa fa-check"></i><b>10</b> RStudio Projects</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rstudio-projects.html"><a href="rstudio-projects.html#file-paths-and-working-directories"><i class="fa fa-check"></i><b>10.1</b> File paths and working directories</a></li>
<li class="chapter" data-level="10.2" data-path="rstudio-projects.html"><a href="rstudio-projects.html#creating-a-new-project"><i class="fa fa-check"></i><b>10.2</b> Creating a new project</a></li>
<li class="chapter" data-level="10.3" data-path="rstudio-projects.html"><a href="rstudio-projects.html#opening-an-existing-project"><i class="fa fa-check"></i><b>10.3</b> Opening an existing project</a></li>
<li class="chapter" data-level="10.4" data-path="rstudio-projects.html"><a href="rstudio-projects.html#using-your-project-folder"><i class="fa fa-check"></i><b>10.4</b> Using your project folder</a></li>
</ul></li>
<li class="part"><span><b>II Data handling</b></span></li>
<li class="chapter" data-level="11" data-path="the-tidyverse.html"><a href="the-tidyverse.html"><i class="fa fa-check"></i><b>11</b> The Tidyverse</a></li>
<li class="chapter" data-level="12" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html"><i class="fa fa-check"></i><b>12</b> Importing, combining, and reshaping data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#importing-a-.csv-file"><i class="fa fa-check"></i><b>12.1</b> Importing a .csv file</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#additional-arguments"><i class="fa fa-check"></i><b>12.1.1</b> Additional arguments</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#importing-an-excel-.xlsx-file"><i class="fa fa-check"></i><b>12.2</b> Importing an Excel .xlsx file</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#additional-arguments-1"><i class="fa fa-check"></i><b>12.2.1</b> Additional arguments</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#importing-a-plain-text-file"><i class="fa fa-check"></i><b>12.3</b> Importing a plain text file</a></li>
<li class="chapter" data-level="12.4" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#importing-online-data"><i class="fa fa-check"></i><b>12.4</b> Importing online data</a></li>
<li class="chapter" data-level="12.5" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#working-with-column-names"><i class="fa fa-check"></i><b>12.5</b> Working with column names</a></li>
<li class="chapter" data-level="12.6" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#combining-data-frames"><i class="fa fa-check"></i><b>12.6</b> Combining data frames</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#adding-columns"><i class="fa fa-check"></i><b>12.6.1</b> Adding columns</a></li>
<li class="chapter" data-level="12.6.2" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#adding-rows"><i class="fa fa-check"></i><b>12.6.2</b> Adding rows</a></li>
<li class="chapter" data-level="12.6.3" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#data-frames-from-lists"><i class="fa fa-check"></i><b>12.6.3</b> Data frames from lists</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#renaming-columns"><i class="fa fa-check"></i><b>12.7</b> Renaming columns</a></li>
<li class="chapter" data-level="12.8" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#importing-data-from-other-statistical-packages"><i class="fa fa-check"></i><b>12.8</b> Importing data from other statistical packages</a></li>
<li class="chapter" data-level="12.9" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#reshaping-data-frames"><i class="fa fa-check"></i><b>12.9</b> Reshaping data frames</a></li>
<li class="chapter" data-level="12.10" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#exBrexit"><i class="fa fa-check"></i><b>12.10</b> Exercises</a></li>
<li class="chapter" data-level="12.11" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#data-sources"><i class="fa fa-check"></i><b>12.11</b> Data sources</a></li>
<li class="chapter" data-level="12.12" data-path="importing-combining-and-reshaping-data.html"><a href="importing-combining-and-reshaping-data.html#further-reading-2"><i class="fa fa-check"></i><b>12.12</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="data-handling-with-dplyr.html"><a href="data-handling-with-dplyr.html"><i class="fa fa-check"></i><b>13</b> Data handling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="13.1" data-path="data-handling-with-dplyr.html"><a href="data-handling-with-dplyr.html#chaining-commands-together-with-the-pipe-operator"><i class="fa fa-check"></i><b>13.1</b> Chaining commands together with the pipe operator <code>%&gt;%</code></a></li>
<li class="chapter" data-level="13.2" data-path="data-handling-with-dplyr.html"><a href="data-handling-with-dplyr.html#example"><i class="fa fa-check"></i><b>13.2</b> Example</a></li>
<li class="chapter" data-level="13.3" data-path="data-handling-with-dplyr.html"><a href="data-handling-with-dplyr.html#ordering-the-rows-by-a-variable-with-the-arrange-command"><i class="fa fa-check"></i><b>13.3</b> Ordering the rows by a variable with the <code>arrange()</code> command</a></li>
<li class="chapter" data-level="13.4" data-path="data-handling-with-dplyr.html"><a href="data-handling-with-dplyr.html#selecting-rows-with-the-filter-command"><i class="fa fa-check"></i><b>13.4</b> Selecting rows with the <code>filter()</code> command</a></li>
<li class="chapter" data-level="13.5" data-path="data-handling-with-dplyr.html"><a href="data-handling-with-dplyr.html#viewing-and-extracting-data-from-a-column"><i class="fa fa-check"></i><b>13.5</b> Viewing and extracting data from a column</a></li>
<li class="chapter" data-level="13.6" data-path="data-handling-with-dplyr.html"><a href="data-handling-with-dplyr.html#creating-new-columns-in-a-data-frame-with-the-mutate-command"><i class="fa fa-check"></i><b>13.6</b> Creating new columns in a data frame with the <code>mutate()</code> command</a></li>
<li class="chapter" data-level="13.7" data-path="data-handling-with-dplyr.html"><a href="data-handling-with-dplyr.html#computing-summaries-per-group"><i class="fa fa-check"></i><b>13.7</b> Computing summaries per group</a></li>
<li class="chapter" data-level="13.8" data-path="data-handling-with-dplyr.html"><a href="data-handling-with-dplyr.html#counting-observations-within-groups"><i class="fa fa-check"></i><b>13.8</b> Counting observations within groups</a></li>
<li class="chapter" data-level="13.9" data-path="data-handling-with-dplyr.html"><a href="data-handling-with-dplyr.html#further-reading-3"><i class="fa fa-check"></i><b>13.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>14</b> Strings</a>
<ul>
<li class="chapter" data-level="14.1" data-path="strings.html"><a href="strings.html#example-fictitous-exam-mark-data"><i class="fa fa-check"></i><b>14.1</b> Example: (fictitous) exam mark data</a></li>
<li class="chapter" data-level="14.2" data-path="strings.html"><a href="strings.html#importing-text-data-with-read_lines"><i class="fa fa-check"></i><b>14.2</b> Importing text data with <code>read_lines()</code></a></li>
<li class="chapter" data-level="14.3" data-path="strings.html"><a href="strings.html#finding-and-replacing-characters-in-strings"><i class="fa fa-check"></i><b>14.3</b> Finding (and replacing) characters in strings</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="strings.html"><a href="strings.html#finding-text-with-str_which"><i class="fa fa-check"></i><b>14.3.1</b> Finding text with <code>str_which()</code></a></li>
<li class="chapter" data-level="14.3.2" data-path="strings.html"><a href="strings.html#escape-characters-and-regular-expressions"><i class="fa fa-check"></i><b>14.3.2</b> Escape characters and regular expressions</a></li>
<li class="chapter" data-level="14.3.3" data-path="strings.html"><a href="strings.html#replacing-or-removing-text"><i class="fa fa-check"></i><b>14.3.3</b> Replacing or removing text</a></li>
<li class="chapter" data-level="14.3.4" data-path="strings.html"><a href="strings.html#removing-white-space-at-startend-of-strings"><i class="fa fa-check"></i><b>14.3.4</b> Removing white space at start/end of strings</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="strings.html"><a href="strings.html#subsetting-strings"><i class="fa fa-check"></i><b>14.4</b> Subsetting strings</a></li>
<li class="chapter" data-level="14.5" data-path="strings.html"><a href="strings.html#making-a-data-frame"><i class="fa fa-check"></i><b>14.5</b> Making a data frame</a></li>
<li class="chapter" data-level="14.6" data-path="strings.html"><a href="strings.html#further-reading-4"><i class="fa fa-check"></i><b>14.6</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="processing-multiple-files.html"><a href="processing-multiple-files.html"><i class="fa fa-check"></i><b>15</b> Processing multiple files</a>
<ul>
<li class="chapter" data-level="15.1" data-path="processing-multiple-files.html"><a href="processing-multiple-files.html#repeating-a-process-with-a-for-loop"><i class="fa fa-check"></i><b>15.1</b> Repeating a process with a <code>for</code> loop</a></li>
<li class="chapter" data-level="15.2" data-path="processing-multiple-files.html"><a href="processing-multiple-files.html#example-cleaning-two-text-files"><i class="fa fa-check"></i><b>15.2</b> Example: cleaning two text files</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="processing-multiple-files.html"><a href="processing-multiple-files.html#the-core-code-block"><i class="fa fa-check"></i><b>15.2.1</b> The core code block</a></li>
<li class="chapter" data-level="15.2.2" data-path="processing-multiple-files.html"><a href="processing-multiple-files.html#identify-the-variables-we-need-to-specify"><i class="fa fa-check"></i><b>15.2.2</b> Identify the variables we need to specify</a></li>
<li class="chapter" data-level="15.2.3" data-path="processing-multiple-files.html"><a href="processing-multiple-files.html#create-an-empty-list-to-store-the-results"><i class="fa fa-check"></i><b>15.2.3</b> Create an empty list to store the results</a></li>
<li class="chapter" data-level="15.2.4" data-path="processing-multiple-files.html"><a href="processing-multiple-files.html#use-a-for-loop-to-run-the-code-block-multiple-times"><i class="fa fa-check"></i><b>15.2.4</b> Use a for loop to run the code block multiple times</a></li>
<li class="chapter" data-level="15.2.5" data-path="processing-multiple-files.html"><a href="processing-multiple-files.html#convert-the-list-to-a-data-frame"><i class="fa fa-check"></i><b>15.2.5</b> Convert the list to a data frame</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="processing-multiple-files.html"><a href="processing-multiple-files.html#exercise"><i class="fa fa-check"></i><b>15.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="apis.html"><a href="apis.html"><i class="fa fa-check"></i><b>16</b> APIs</a>
<ul>
<li class="chapter" data-level="16.1" data-path="apis.html"><a href="apis.html#example-obtaining-covid-19-case-data-data-in-json-format"><i class="fa fa-check"></i><b>16.1</b> Example: obtaining Covid-19 case data (data in JSON format)</a></li>
<li class="chapter" data-level="16.2" data-path="apis.html"><a href="apis.html#exExcel"><i class="fa fa-check"></i><b>16.2</b> Example: obtaining an .xlsx file</a></li>
<li class="chapter" data-level="16.3" data-path="apis.html"><a href="apis.html#exercise-1"><i class="fa fa-check"></i><b>16.3</b> Exercise</a></li>
<li class="chapter" data-level="16.4" data-path="apis.html"><a href="apis.html#acknowledgements-1"><i class="fa fa-check"></i><b>16.4</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>17</b> Missing data</a>
<ul>
<li class="chapter" data-level="17.1" data-path="missing-data.html"><a href="missing-data.html#na"><i class="fa fa-check"></i><b>17.1</b> <code>NA</code></a></li>
<li class="chapter" data-level="17.2" data-path="missing-data.html"><a href="missing-data.html#functions-and-na"><i class="fa fa-check"></i><b>17.2</b> Functions and <code>NA</code></a></li>
<li class="chapter" data-level="17.3" data-path="missing-data.html"><a href="missing-data.html#imputation"><i class="fa fa-check"></i><b>17.3</b> Imputation</a></li>
<li class="chapter" data-level="17.4" data-path="missing-data.html"><a href="missing-data.html#visualising-missing-data"><i class="fa fa-check"></i><b>17.4</b> Visualising missing data</a></li>
<li class="chapter" data-level="17.5" data-path="missing-data.html"><a href="missing-data.html#exercise-2"><i class="fa fa-check"></i><b>17.5</b> Exercise</a></li>
<li class="chapter" data-level="17.6" data-path="missing-data.html"><a href="missing-data.html#further-reading-5"><i class="fa fa-check"></i><b>17.6</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>III Plotting data</b></span></li>
<li class="chapter" data-level="18" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html"><i class="fa fa-check"></i><b>18</b> Making plots with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="18.1" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#the-general-syntax"><i class="fa fa-check"></i><b>18.1</b> The general syntax</a></li>
<li class="chapter" data-level="18.2" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#scatter-plots"><i class="fa fa-check"></i><b>18.2</b> Scatter plots</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#annotating-a-scatter-plot"><i class="fa fa-check"></i><b>18.2.1</b> Annotating a scatter plot</a></li>
<li class="chapter" data-level="18.2.2" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#adding-a-trend"><i class="fa fa-check"></i><b>18.2.2</b> Adding a trend</a></li>
<li class="chapter" data-level="18.2.3" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#representing-more-than-two-variables-on-a-scatter-plot"><i class="fa fa-check"></i><b>18.2.3</b> Representing more than two variables on a scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#histograms"><i class="fa fa-check"></i><b>18.3</b> Histograms</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#customising-a-histogram-plot-in-r"><i class="fa fa-check"></i><b>18.3.1</b> Customising a histogram plot in R</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#box-plots"><i class="fa fa-check"></i><b>18.4</b> Box plots</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#adding-the-observations-to-a-box-plot"><i class="fa fa-check"></i><b>18.4.1</b> Adding the observations to a box plot</a></li>
<li class="chapter" data-level="18.4.2" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#violin-plots"><i class="fa fa-check"></i><b>18.4.2</b> Violin plots</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#global-aesthetics"><i class="fa fa-check"></i><b>18.5</b> ‘Global’ aesthetics</a></li>
<li class="chapter" data-level="18.6" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>18.6</b> Facets</a></li>
<li class="chapter" data-level="18.7" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#exBrexitPlots"><i class="fa fa-check"></i><b>18.7</b> Exercises</a></li>
<li class="chapter" data-level="18.8" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#further-reading-6"><i class="fa fa-check"></i><b>18.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html"><i class="fa fa-check"></i><b>19</b> Presentation of plots</a>
<ul>
<li class="chapter" data-level="19.1" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#the-basics"><i class="fa fa-check"></i><b>19.1</b> The basics</a></li>
<li class="chapter" data-level="19.2" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#the-caption-test"><i class="fa fa-check"></i><b>19.2</b> The caption test</a></li>
<li class="chapter" data-level="19.3" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#caption-or-title"><i class="fa fa-check"></i><b>19.3</b> Caption or title?</a></li>
<li class="chapter" data-level="19.4" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#customising-the-appearance-of-a-plot"><i class="fa fa-check"></i><b>19.4</b> Customising the appearance of a plot</a></li>
<li class="chapter" data-level="19.5" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#refining-a-plot-an-example"><i class="fa fa-check"></i><b>19.5</b> Refining a plot: an example</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#the-data-to-plot"><i class="fa fa-check"></i><b>19.5.1</b> The data to plot</a></li>
<li class="chapter" data-level="19.5.2" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#a-first-attempt-four-histograms"><i class="fa fa-check"></i><b>19.5.2</b> A first attempt: four histograms</a></li>
<li class="chapter" data-level="19.5.3" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#using-a-box-plot"><i class="fa fa-check"></i><b>19.5.3</b> Using a box plot</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#exercises"><i class="fa fa-check"></i><b>19.6</b> Exercises</a></li>
<li class="chapter" data-level="19.7" data-path="presentation-of-plots.html"><a href="presentation-of-plots.html#data-sources-1"><i class="fa fa-check"></i><b>19.7</b> Data sources</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html"><i class="fa fa-check"></i><b>20</b> Maps with <code>leaflet</code></a>
<ul>
<li class="chapter" data-level="20.1" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#a-basic-map"><i class="fa fa-check"></i><b>20.1</b> A basic map</a></li>
<li class="chapter" data-level="20.2" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#indicating-points-on-a-map"><i class="fa fa-check"></i><b>20.2</b> Indicating points on a map</a></li>
<li class="chapter" data-level="20.3" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#plotting-region-boundaries"><i class="fa fa-check"></i><b>20.3</b> Plotting region boundaries</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#shapefiles"><i class="fa fa-check"></i><b>20.3.1</b> shapefiles</a></li>
<li class="chapter" data-level="20.3.2" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#importing-and-simplifying-shapefiles"><i class="fa fa-check"></i><b>20.3.2</b> Importing and simplifying shapefiles</a></li>
<li class="chapter" data-level="20.3.3" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#plotting-the-boundaries"><i class="fa fa-check"></i><b>20.3.3</b> Plotting the boundaries</a></li>
<li class="chapter" data-level="20.3.4" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#using-different-colours-for-regions"><i class="fa fa-check"></i><b>20.3.4</b> Using different colours for regions</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#further-reading-7"><i class="fa fa-check"></i><b>20.4</b> Further reading</a></li>
<li class="chapter" data-level="20.5" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#acknowledgement"><i class="fa fa-check"></i><b>20.5</b> Acknowledgement</a></li>
<li class="chapter" data-level="20.6" data-path="maps-with-leaflet.html"><a href="maps-with-leaflet.html#references"><i class="fa fa-check"></i><b>20.6</b> References:</a></li>
</ul></li>
<li class="part"><span><b>IV Presenting your results</b></span></li>
<li class="chapter" data-level="21" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>21</b> R Markdown</a>
<ul>
<li class="chapter" data-level="21.1" data-path="r-markdown.html"><a href="r-markdown.html#a-five-minute-video-tutorial"><i class="fa fa-check"></i><b>21.1</b> A five minute video tutorial</a></li>
<li class="chapter" data-level="21.2" data-path="r-markdown.html"><a href="r-markdown.html#working-directories-for-r-markdown-documents"><i class="fa fa-check"></i><b>21.2</b> Working directories for R Markdown documents</a></li>
<li class="chapter" data-level="21.3" data-path="r-markdown.html"><a href="r-markdown.html#code-chunk-options"><i class="fa fa-check"></i><b>21.3</b> Code chunk options</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="r-markdown.html"><a href="r-markdown.html#code-chunk-options-for-figures"><i class="fa fa-check"></i><b>21.3.1</b> Code chunk options for figures</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="r-markdown.html"><a href="r-markdown.html#tables"><i class="fa fa-check"></i><b>21.4</b> Tables</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="r-markdown.html"><a href="r-markdown.html#using-markdown"><i class="fa fa-check"></i><b>21.4.1</b> Using Markdown</a></li>
<li class="chapter" data-level="21.4.2" data-path="r-markdown.html"><a href="r-markdown.html#using-knitrkable"><i class="fa fa-check"></i><b>21.4.2</b> Using <code>knitr::kable()</code></a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="r-markdown.html"><a href="r-markdown.html#caching-results-for-slow-running-code"><i class="fa fa-check"></i><b>21.5</b> Caching results for slow-running code</a></li>
<li class="chapter" data-level="21.6" data-path="r-markdown.html"><a href="r-markdown.html#spell-checking"><i class="fa fa-check"></i><b>21.6</b> Spell checking</a></li>
<li class="chapter" data-level="21.7" data-path="r-markdown.html"><a href="r-markdown.html#the-yaml-header"><i class="fa fa-check"></i><b>21.7</b> The YAML header</a></li>
<li class="chapter" data-level="21.8" data-path="r-markdown.html"><a href="r-markdown.html#latex-markdown-and-html"><i class="fa fa-check"></i><b>21.8</b> LaTeX, Markdown and html</a></li>
<li class="chapter" data-level="21.9" data-path="r-markdown.html"><a href="r-markdown.html#bookdown"><i class="fa fa-check"></i><b>21.9</b> bookdown</a></li>
<li class="chapter" data-level="21.10" data-path="r-markdown.html"><a href="r-markdown.html#quarto"><i class="fa fa-check"></i><b>21.10</b> Quarto</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="referencing.html"><a href="referencing.html"><i class="fa fa-check"></i><b>22</b> Referencing</a>
<ul>
<li class="chapter" data-level="22.1" data-path="referencing.html"><a href="referencing.html#referencing-data-sets"><i class="fa fa-check"></i><b>22.1</b> Referencing data sets</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="referencing.html"><a href="referencing.html#attribution-statements-and-conditions-of-use"><i class="fa fa-check"></i><b>22.1.1</b> Attribution statements and conditions of use</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="referencing.html"><a href="referencing.html#citing-r-and-r-packages"><i class="fa fa-check"></i><b>22.2</b> Citing R and R packages</a></li>
<li class="chapter" data-level="22.3" data-path="referencing.html"><a href="referencing.html#using-someone-elses-figures-in-your-work"><i class="fa fa-check"></i><b>22.3</b> Using someone else’s figures in your work</a></li>
<li class="chapter" data-level="22.4" data-path="referencing.html"><a href="referencing.html#further-reading."><i class="fa fa-check"></i><b>22.4</b> Further reading.</a></li>
<li class="chapter" data-level="22.5" data-path="referencing.html"><a href="referencing.html#exercise-3"><i class="fa fa-check"></i><b>22.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>23</b> Shiny</a>
<ul>
<li class="chapter" data-level="23.1" data-path="shiny.html"><a href="shiny.html#some-example-r-code-for-inclusion-in-an-app"><i class="fa fa-check"></i><b>23.1</b> Some example R code, for inclusion in an app</a></li>
<li class="chapter" data-level="23.2" data-path="shiny.html"><a href="shiny.html#putting-the-code-inside-an-app"><i class="fa fa-check"></i><b>23.2</b> Putting the code inside an app</a></li>
<li class="chapter" data-level="23.3" data-path="shiny.html"><a href="shiny.html#the-user-interface-ui"><i class="fa fa-check"></i><b>23.3</b> The user interface <code>ui</code></a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="shiny.html"><a href="shiny.html#commands-widgets-for-creating-user-controls-and-inputs"><i class="fa fa-check"></i><b>23.3.1</b> Commands (“widgets”) for creating user controls and inputs</a></li>
<li class="chapter" data-level="23.3.2" data-path="shiny.html"><a href="shiny.html#commands-for-producing-outputs"><i class="fa fa-check"></i><b>23.3.2</b> Commands for producing outputs</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="shiny.html"><a href="shiny.html#the-server"><i class="fa fa-check"></i><b>23.4</b> The <code>server</code></a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="shiny.html"><a href="shiny.html#making-a-plot"><i class="fa fa-check"></i><b>23.4.1</b> Making a plot</a></li>
<li class="chapter" data-level="23.4.2" data-path="shiny.html"><a href="shiny.html#making-a-table"><i class="fa fa-check"></i><b>23.4.2</b> Making a table</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="shiny.html"><a href="shiny.html#reactivity"><i class="fa fa-check"></i><b>23.5</b> Reactivity</a></li>
<li class="chapter" data-level="23.6" data-path="shiny.html"><a href="shiny.html#customising-the-appearance-of-your-app"><i class="fa fa-check"></i><b>23.6</b> Customising the appearance of your app</a></li>
<li class="chapter" data-level="23.7" data-path="shiny.html"><a href="shiny.html#shiny-with-r-markdown"><i class="fa fa-check"></i><b>23.7</b> Shiny with R Markdown</a></li>
<li class="chapter" data-level="23.8" data-path="shiny.html"><a href="shiny.html#further-reading-8"><i class="fa fa-check"></i><b>23.8</b> Further reading</a></li>
</ul></li>
<li class="part"><span><b>V Miscellaneous</b></span></li>
<li class="chapter" data-level="24" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html"><i class="fa fa-check"></i><b>24</b> EDA for logistic regression</a>
<ul>
<li class="chapter" data-level="24.1" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#example-a-balance-study"><i class="fa fa-check"></i><b>24.1</b> Example: a balance study</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#terminology"><i class="fa fa-check"></i><b>24.1.1</b> Terminology</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#what-to-look-for-in-an-eda"><i class="fa fa-check"></i><b>24.2</b> What to look for in an EDA</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#what-to-plot"><i class="fa fa-check"></i><b>24.2.1</b> What to plot</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#investigating-the-experimental-design"><i class="fa fa-check"></i><b>24.3</b> Investigating the experimental design</a></li>
<li class="chapter" data-level="24.4" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#contingency-tables"><i class="fa fa-check"></i><b>24.4</b> Contingency tables</a></li>
<li class="chapter" data-level="24.5" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#checking-for-identical-responses"><i class="fa fa-check"></i><b>24.5</b> Checking for identical responses</a></li>
<li class="chapter" data-level="24.6" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#exploratory-plots"><i class="fa fa-check"></i><b>24.6</b> Exploratory plots</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#a-simple-box-plot"><i class="fa fa-check"></i><b>24.6.1</b> A simple box plot</a></li>
<li class="chapter" data-level="24.6.2" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#interactions"><i class="fa fa-check"></i><b>24.6.2</b> Interactions</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#plotting-mean-proportions"><i class="fa fa-check"></i><b>24.7</b> Plotting mean proportions</a></li>
<li class="chapter" data-level="24.8" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#plotting-fitted-logistic-regression-lines"><i class="fa fa-check"></i><b>24.8</b> Plotting fitted logistic regression lines</a>
<ul>
<li class="chapter" data-level="24.8.1" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#plots-with-bernoulli-data"><i class="fa fa-check"></i><b>24.8.1</b> Plots with Bernoulli data</a></li>
<li class="chapter" data-level="24.8.2" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#plots-with-binomial-n1-data"><i class="fa fa-check"></i><b>24.8.2</b> Plots with Binomial <span class="math inline">\((n&gt;1)\)</span> data</a></li>
</ul></li>
<li class="chapter" data-level="24.9" data-path="eda-for-logistic-regression.html"><a href="eda-for-logistic-regression.html#summary"><i class="fa fa-check"></i><b>24.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="example-working-with-strings.html"><a href="example-working-with-strings.html"><i class="fa fa-check"></i><b>25</b> Example: working with strings</a>
<ul>
<li class="chapter" data-level="25.1" data-path="example-working-with-strings.html"><a href="example-working-with-strings.html#importing-the-two-data-files"><i class="fa fa-check"></i><b>25.1</b> Importing the two data files</a></li>
<li class="chapter" data-level="25.2" data-path="example-working-with-strings.html"><a href="example-working-with-strings.html#preliminary-tidying"><i class="fa fa-check"></i><b>25.2</b> Preliminary tidying</a></li>
<li class="chapter" data-level="25.3" data-path="example-working-with-strings.html"><a href="example-working-with-strings.html#approximately-matching-strings"><i class="fa fa-check"></i><b>25.3</b> Approximately matching strings</a></li>
<li class="chapter" data-level="25.4" data-path="example-working-with-strings.html"><a href="example-working-with-strings.html#assembling-the-target-data-frame"><i class="fa fa-check"></i><b>25.4</b> Assembling the target data frame</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data handling, exploratory analysis, and reporting in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="making-plots-with-ggplot2" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">Section 18</span> Making plots with <code>ggplot2</code><a href="making-plots-with-ggplot2.html#making-plots-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>R has different choices available for using plots. Two commonly used options are ‘base graphics’ (e.g. using commands such as <code>plot()</code>, <code>hist()</code>, <code>boxplot()</code>) and the package <code>ggplot2</code> <span class="citation">(<a href="#ref-R-ggplot2">Wickham, Chang, et al. 2020</a>)</span>, <span class="citation">(<a href="#ref-ggplot22016">Wickham 2016</a>)</span>. It’s a matter of personal preference which you should use; I like to use both: base graphics for drawing diagrams, and <code>ggplot2</code> for plotting data from data frames. In these notes we will discuss <code>ggplot2</code>.</p>
<p><img src="images/ggplot2_masterpiece.png" width="60%" style="display: block; margin: auto;" />
(Artwork by @allison_horst)</p>
<div class="rmdnote">
<p>
In this section, we’ll concentrate on how to make different types of
plots. You’ll almost certainly need to customise the appearance of your
plot, but we’ll leave that until the next section.
</p>
</div>
<p>We’ll work through some examples in the next sections. To try these out on your own computer, you’ll need to load the tidyverse and import the <code>maths.csv</code> data, and create the <code>wealthiest</code> column. The commands to do this all are below.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="making-plots-with-ggplot2.html#cb259-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb259-2"><a href="making-plots-with-ggplot2.html#cb259-2" tabindex="-1"></a>maths <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://oakleyj.github.io/exampledata/maths.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-3"><a href="making-plots-with-ggplot2.html#cb259-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wealthiest =</span> gdp <span class="sc">&gt;</span> <span class="dv">17000</span>)</span></code></pre></div>
<div id="the-general-syntax" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> The general syntax<a href="making-plots-with-ggplot2.html#the-general-syntax" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As an example, we’ll first produce a scatter plot:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="making-plots-with-ggplot2.html#cb260-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb260-2"><a href="making-plots-with-ggplot2.html#cb260-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb260-3"><a href="making-plots-with-ggplot2.html#cb260-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>,</span>
<span id="cb260-4"><a href="making-plots-with-ggplot2.html#cb260-4" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-188-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The syntax can look a little complicated to start but you should get used to it! Some general points are as follows.</p>
<div class="rmdnote">
<p>
There is quite a lot to take in here, so just skim read for now, and
then have another look once you seen some examples in the following
sections.
</p>
</div>
<ul>
<li>The data we want to plot must be in a data frame.</li>
<li>All plots begin with a <code>ggplot()</code> command, specifying the data frame we are using (<code>maths</code> in this case).</li>
<li>We use the <code>aes()</code> any time we want something on the plot to represent values in a data frame column, e.g
<ul>
<li>the position of a point on the <span class="math inline">\(x\)</span>-axis or <span class="math inline">\(y\)</span>-axis;</li>
<li>the colour of a point (different colours depending on variable values). This is sometimes referred to as ‘mapping a column to an aesthetic’. In the example, we mapped the <code>gdp</code> column onto the <span class="math inline">\(x\)</span>-axis, and the <code>score</code> column to the <span class="math inline">\(y\)</span>-axis.</li>
</ul></li>
<li>Any feature of the points <em>not</em> related to columns in the data frame are specified <em>outside</em> of an <code>aes()</code> command. Here we used
<ul>
<li><code>size</code> to make the points a little larger</li>
<li><code>alpha</code> to make the points transparent (helpful when points are overlapping.)</li>
</ul></li>
<li>The actual type of plot is specified as a “geom”. There will be different <code>geom</code> commands for scatter plots, box plots, histograms etc. We used <code>geom_point()</code> to make a scatter plot.</li>
<li>We use the <code>+</code> symbol to combine commands and make a single plot. In the example we’ve added a command to give axes labels.</li>
</ul>
</div>
<div id="scatter-plots" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> Scatter plots<a href="making-plots-with-ggplot2.html#scatter-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve seen a scatter plot already, but we’ll repeat the basic syntax here:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="making-plots-with-ggplot2.html#cb261-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb261-2"><a href="making-plots-with-ggplot2.html#cb261-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-190-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Note that, without the <code>labs()</code> command, the axes labels are just the column names.</p>
<div class="rmdnote">
<p>
In any report that you write, you will almost certainly need to
specify your own axes labels; the column names will not be suitable. In
your labels, include the units of measurement, if appropriate.
</p>
</div>
<div id="annotating-a-scatter-plot" class="section level3 hasAnchor" number="18.2.1">
<h3><span class="header-section-number">18.2.1</span> Annotating a scatter plot<a href="making-plots-with-ggplot2.html#annotating-a-scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We may wish to annotate a plot, e.g. labelling a single observation. Here’s an example of labelling the UK (GDP = 39899, score = 492). We’ll also include proper axes labels.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="making-plots-with-ggplot2.html#cb262-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb262-2"><a href="making-plots-with-ggplot2.html#cb262-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb262-3"><a href="making-plots-with-ggplot2.html#cb262-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>,</span>
<span id="cb262-4"><a href="making-plots-with-ggplot2.html#cb262-4" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span></span>
<span id="cb262-5"><a href="making-plots-with-ggplot2.html#cb262-5" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;point&quot;</span>, <span class="at">x =</span> <span class="dv">39899</span>, <span class="at">y =</span> <span class="dv">492</span>,</span>
<span id="cb262-6"><a href="making-plots-with-ggplot2.html#cb262-6" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb262-7"><a href="making-plots-with-ggplot2.html#cb262-7" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;UK&quot;</span>, <span class="at">x =</span> <span class="dv">39899</span>,</span>
<span id="cb262-8"><a href="making-plots-with-ggplot2.html#cb262-8" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">492</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb262-9"><a href="making-plots-with-ggplot2.html#cb262-9" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-192-1.png" width="384" style="display: block; margin: auto;" /></p>
<ul>
<li>The first <code>annotate()</code> command adds a red circle (<code>"point"</code>) at the coordinates <span class="math inline">\(x=39899\)</span>, <span class="math inline">\(y=492\)</span> (corresponding to the UK), with the <code>size</code> set to 2 to make it a little larger.</li>
<li>The second <code>annotate()</code> command adds some red text (UK) at the coordinates <span class="math inline">\(x=39899\)</span>, <span class="math inline">\(y=492\)</span>, with the arguments <code>hjust</code> and <code>vjust</code> shifting the text slightly horizontally and vertically, so that it appears next to, rather than on top of the red dot. It can take a little trial and error to find the values for <code>hjust</code> and <code>vjust</code> that you are happy with.</li>
</ul>
<div class="rmdnote">
<p>
Adding text labels to points can be awkward! Fortunately there is a
nice package <code>ggrepel</code> <span class="citation"><span class="citation">(<a href="#ref-R-ggrepel">Slowikowski 2020</a>)</span></span> that does various useful things,
such as automatically pushing text labels away from each other, whilst
still making clear which labels go with which points. <a
href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html"
target="_blank">Some examples of using <code>ggrepel</code> are
described here</a>.
</p>
</div>
</div>
<div id="adding-a-trend" class="section level3 hasAnchor" number="18.2.2">
<h3><span class="header-section-number">18.2.2</span> Adding a trend<a href="making-plots-with-ggplot2.html#adding-a-trend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can see clearly that maths scores tend to increase as GDP per capita increases, but the relationship doesn’t look linear. If we want to emphasise such a relationship, we can add the trend to the plot, using the extra line <code>geom_smooth()</code> in the plot command:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="making-plots-with-ggplot2.html#cb263-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb263-2"><a href="making-plots-with-ggplot2.html#cb263-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb263-3"><a href="making-plots-with-ggplot2.html#cb263-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>, </span>
<span id="cb263-4"><a href="making-plots-with-ggplot2.html#cb263-4" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span></span>
<span id="cb263-5"><a href="making-plots-with-ggplot2.html#cb263-5" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;point&quot;</span>, <span class="at">x =</span> <span class="dv">39899</span>, </span>
<span id="cb263-6"><a href="making-plots-with-ggplot2.html#cb263-6" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">492</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb263-7"><a href="making-plots-with-ggplot2.html#cb263-7" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb263-8"><a href="making-plots-with-ggplot2.html#cb263-8" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;UK&quot;</span>, </span>
<span id="cb263-9"><a href="making-plots-with-ggplot2.html#cb263-9" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">39899</span>, <span class="at">y =</span> <span class="dv">492</span>, </span>
<span id="cb263-10"><a href="making-plots-with-ggplot2.html#cb263-10" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb263-11"><a href="making-plots-with-ggplot2.html#cb263-11" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb263-12"><a href="making-plots-with-ggplot2.html#cb263-12" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-194-1.png" width="384" style="display: block; margin: auto;" />
The blue line shows the estimated trend. The grey shaded area indicates uncertainty about this trend (it’s wider on the right hand side, because we have less data there).</p>
<p>If we want to plot a linear trend, we add the argument <code>method = "lm"</code> to <code>geom_smooth()</code> (we can use various regression methods within <code>geom_smooth()</code>):</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="making-plots-with-ggplot2.html#cb264-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths,  </span>
<span id="cb264-2"><a href="making-plots-with-ggplot2.html#cb264-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb264-3"><a href="making-plots-with-ggplot2.html#cb264-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb264-4"><a href="making-plots-with-ggplot2.html#cb264-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb264-5"><a href="making-plots-with-ggplot2.html#cb264-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Gini coeffcient&quot;</span>, </span>
<span id="cb264-6"><a href="making-plots-with-ggplot2.html#cb264-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) </span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-195-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="representing-more-than-two-variables-on-a-scatter-plot" class="section level3 hasAnchor" number="18.2.3">
<h3><span class="header-section-number">18.2.3</span> Representing more than two variables on a scatter plot<a href="making-plots-with-ggplot2.html#representing-more-than-two-variables-on-a-scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can represent a third variable using colour. Additional variables can be presented using size and shape, although care is needed here; the plot could get difficult to read.</p>
<div id="colours-for-qualitative-variables" class="section level4 hasAnchor" number="18.2.3.1">
<h4><span class="header-section-number">18.2.3.1</span> Colours for qualitative variables<a href="making-plots-with-ggplot2.html#colours-for-qualitative-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here’s an example using colour to represent <code>continent</code></p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="making-plots-with-ggplot2.html#cb265-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, </span>
<span id="cb265-2"><a href="making-plots-with-ggplot2.html#cb265-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb265-3"><a href="making-plots-with-ggplot2.html#cb265-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb265-4"><a href="making-plots-with-ggplot2.html#cb265-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>, </span>
<span id="cb265-5"><a href="making-plots-with-ggplot2.html#cb265-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-196-1.png" width="576" style="display: block; margin: auto;" /></p>
<ul>
<li>Note that the mapping of <code>continent</code> to <code>colour</code> has to sit inside the <code>aes()</code> command.</li>
<li>Colours can be specified manually. <code>ggplot2</code> will attempt to use distinctive colours by default, but this can be hard if there are too many groups.</li>
</ul>
</div>
<div id="colours-for-quantitative-variables" class="section level4 hasAnchor" number="18.2.3.2">
<h4><span class="header-section-number">18.2.3.2</span> Colours for quantitative variables<a href="making-plots-with-ggplot2.html#colours-for-quantitative-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here’s an example using colour to represent <code>start.age</code></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="making-plots-with-ggplot2.html#cb266-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, </span>
<span id="cb266-2"><a href="making-plots-with-ggplot2.html#cb266-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb266-3"><a href="making-plots-with-ggplot2.html#cb266-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> start.age)) <span class="sc">+</span></span>
<span id="cb266-4"><a href="making-plots-with-ggplot2.html#cb266-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>, </span>
<span id="cb266-5"><a href="making-plots-with-ggplot2.html#cb266-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-197-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Note how a ‘continuous’ colour scale has been used. As there were only three distinct starting ages in the data, a ‘qualitative’ colour scale might be better here. To do this, we can convert <code>start.age</code> to a factor variable with the plot commands:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="making-plots-with-ggplot2.html#cb267-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, </span>
<span id="cb267-2"><a href="making-plots-with-ggplot2.html#cb267-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb267-3"><a href="making-plots-with-ggplot2.html#cb267-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(start.age))) <span class="sc">+</span></span>
<span id="cb267-4"><a href="making-plots-with-ggplot2.html#cb267-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>, </span>
<span id="cb267-5"><a href="making-plots-with-ggplot2.html#cb267-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-198-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="histograms" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> Histograms<a href="making-plots-with-ggplot2.html#histograms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here’s an example of a histogram of the <code>score</code> variable. We only map one column to an axis, and produce the histogram with <code>geom_histogram()</code>:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="making-plots-with-ggplot2.html#cb268-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span> </span>
<span id="cb268-2"><a href="making-plots-with-ggplot2.html#cb268-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-199-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>We can scale the histogram so that the total area equals 1:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="making-plots-with-ggplot2.html#cb269-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span> ..density..)) <span class="sc">+</span> </span>
<span id="cb269-2"><a href="making-plots-with-ggplot2.html#cb269-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-200-1.png" width="384" style="display: block; margin: auto;" /></p>
<div id="customising-a-histogram-plot-in-r" class="section level3 hasAnchor" number="18.3.1">
<h3><span class="header-section-number">18.3.1</span> Customising a histogram plot in R<a href="making-plots-with-ggplot2.html#customising-a-histogram-plot-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll redraw the plot with different colours, add a better axis label, specify a histogram bin-width of size 10, and indicate the UK’s score with a red dot:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="making-plots-with-ggplot2.html#cb270-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span> </span>
<span id="cb270-2"><a href="making-plots-with-ggplot2.html#cb270-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binwidth =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb270-3"><a href="making-plots-with-ggplot2.html#cb270-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span></span>
<span id="cb270-4"><a href="making-plots-with-ggplot2.html#cb270-4" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;point&quot;</span>, <span class="at">x =</span> <span class="dv">492</span>, <span class="at">y =</span> <span class="dv">0</span>,  <span class="at">size =</span> <span class="dv">4</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-201-1.png" width="384" style="display: block; margin: auto;" /></p>
<ul>
<li>The second line now includes extra arguments: <code>fill</code> sets the colour of the interior of the bars, and <code>colour</code> sets the colour of the bar edges. <code>binwidth</code> sets how wide each bar is on the <span class="math inline">\(x\)</span>-axis;</li>
<li>the third line (<code>labs</code>) specifies the label on the <span class="math inline">\(x\)</span>-axis;</li>
<li>the fourth line (<code>annotate</code>) draws a red circle at the coordinates <span class="math inline">\(x=492, y=0\)</span>, and <code>size = 4</code> increases the size of the circle (the default value for <code>size</code> is 1.)</li>
</ul>
</div>
</div>
<div id="box-plots" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> Box plots<a href="making-plots-with-ggplot2.html#box-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Box plots can be useful for comparing multiple distributions, although you may need to explain to your reader how to interpret them! Here’s an example of a box plot to compare scores between the different continents:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="making-plots-with-ggplot2.html#cb271-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb271-2"><a href="making-plots-with-ggplot2.html#cb271-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb271-3"><a href="making-plots-with-ggplot2.html#cb271-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-202-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>It can be difficult to fit all the labels in on the <span class="math inline">\(x\)</span>-axis. A simple solution is to draw the box plot ‘horizontally’ (and we’ll specify an empty <span class="math inline">\(y\)</span>-axis label as we don’t really need one)</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="making-plots-with-ggplot2.html#cb272-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">y =</span> continent, <span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb272-2"><a href="making-plots-with-ggplot2.html#cb272-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb272-3"><a href="making-plots-with-ggplot2.html#cb272-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>,</span>
<span id="cb272-4"><a href="making-plots-with-ggplot2.html#cb272-4" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>) </span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-203-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>If we wanted to do a box plot of <code>score</code> by <code>start.age</code>, we have to convert <code>start.age</code> to a factor variable using <code>as.factor()</code></p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="making-plots-with-ggplot2.html#cb273-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(start.age), <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb273-2"><a href="making-plots-with-ggplot2.html#cb273-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb273-3"><a href="making-plots-with-ggplot2.html#cb273-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;School starting age&quot;</span>, </span>
<span id="cb273-4"><a href="making-plots-with-ggplot2.html#cb273-4" tabindex="-1"></a>       <span class="at">y =</span>  <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-204-1.png" width="384" style="display: block; margin: auto;" /></p>
<div id="adding-the-observations-to-a-box-plot" class="section level3 hasAnchor" number="18.4.1">
<h3><span class="header-section-number">18.4.1</span> Adding the observations to a box plot<a href="making-plots-with-ggplot2.html#adding-the-observations-to-a-box-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It may be helpful to show the individual observations as well, for example, if the distribution of points within a group is bimodal; this wouldn’t be apparent from a box plot. It can help to ‘jitter’ the points on the group axis so that each point can be seen clearly. This can be done as follows.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="making-plots-with-ggplot2.html#cb274-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(start.age), <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb274-2"><a href="making-plots-with-ggplot2.html#cb274-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb274-3"><a href="making-plots-with-ggplot2.html#cb274-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;School starting age&quot;</span>, </span>
<span id="cb274-4"><a href="making-plots-with-ggplot2.html#cb274-4" tabindex="-1"></a>       <span class="at">y =</span>  <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span></span>
<span id="cb274-5"><a href="making-plots-with-ggplot2.html#cb274-5" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-205-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="violin-plots" class="section level3 hasAnchor" number="18.4.2">
<h3><span class="header-section-number">18.4.2</span> Violin plots<a href="making-plots-with-ggplot2.html#violin-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An alternative to a box plot is a “violin plot”, which plots (mirrored) density estimates for each group.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="making-plots-with-ggplot2.html#cb275-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(start.age), <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb275-2"><a href="making-plots-with-ggplot2.html#cb275-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb275-3"><a href="making-plots-with-ggplot2.html#cb275-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;School starting age&quot;</span>, </span>
<span id="cb275-4"><a href="making-plots-with-ggplot2.html#cb275-4" tabindex="-1"></a>       <span class="at">y =</span>  <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-206-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="global-aesthetics" class="section level2 hasAnchor" number="18.5">
<h2><span class="header-section-number">18.5</span> ‘Global’ aesthetics<a href="making-plots-with-ggplot2.html#global-aesthetics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Aesthetics can be defined in different places, and this affects the appearance of the plot. Here’s an example scatter plot, where we map colour to <code>wealthiest</code> within the <code>geom_point()</code> command</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="making-plots-with-ggplot2.html#cb276-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, </span>
<span id="cb276-2"><a href="making-plots-with-ggplot2.html#cb276-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb276-3"><a href="making-plots-with-ggplot2.html#cb276-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> wealthiest)) <span class="sc">+</span></span>
<span id="cb276-4"><a href="making-plots-with-ggplot2.html#cb276-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Income inequality (Gini coefficient)&quot;</span>, </span>
<span id="cb276-5"><a href="making-plots-with-ggplot2.html#cb276-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span> </span>
<span id="cb276-6"><a href="making-plots-with-ggplot2.html#cb276-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-207-1.png" width="576" style="display: block; margin: auto;" />
Note that the trend specified in <code>geom_smooth()</code> refers to a single trend for all the data. If we instead map <code>wealthiest</code> to colour in the <code>ggplot()</code> command, this now applied ‘globally’ in all the subsequent <code>geom</code> commands:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="making-plots-with-ggplot2.html#cb277-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> maths, </span>
<span id="cb277-2"><a href="making-plots-with-ggplot2.html#cb277-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> gini, <span class="at">y =</span> score, <span class="at">colour =</span> wealthiest)) <span class="sc">+</span></span>
<span id="cb277-3"><a href="making-plots-with-ggplot2.html#cb277-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb277-4"><a href="making-plots-with-ggplot2.html#cb277-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Income inequality (Gini coefficient)&quot;</span>, </span>
<span id="cb277-5"><a href="making-plots-with-ggplot2.html#cb277-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean PISA mathematics score, 2015&quot;</span>) <span class="sc">+</span> </span>
<span id="cb277-6"><a href="making-plots-with-ggplot2.html#cb277-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-208-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="facets" class="section level2 hasAnchor" number="18.6">
<h2><span class="header-section-number">18.6</span> Facets<a href="making-plots-with-ggplot2.html#facets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In some cases, we may wish to create a figure with multiple plots side-by-side, or arranged in a grid. If the plots are of the same type, with the same axes, we can use <em>facets</em>, which will ensure that the scales on each axes are the same, making comparison between the plots easier.</p>
<p>For example, suppose we want a separate scatter plot of <code>score</code> against <code>gdp</code>, for each value of <code>start.age</code>. We can do this as follows.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="making-plots-with-ggplot2.html#cb278-1" tabindex="-1"></a><span class="fu">ggplot</span>(maths, <span class="fu">aes</span>(<span class="at">x =</span> gdp, <span class="at">y =</span> score)) <span class="sc">+</span> </span>
<span id="cb278-2"><a href="making-plots-with-ggplot2.html#cb278-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb278-3"><a href="making-plots-with-ggplot2.html#cb278-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(start.age))</span></code></pre></div>
<p><img src="EDA-R_files/figure-html/unnamed-chunk-209-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>See <code>?facet_grid</code> and also <code>?facet_wrap</code> for more details (look at the examples in particular, for the different ways these plots can be laid out.)</p>
</div>
<div id="exBrexitPlots" class="section level2 hasAnchor" number="18.7">
<h2><span class="header-section-number">18.7</span> Exercises<a href="making-plots-with-ggplot2.html#exBrexitPlots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="task">
<div class="exercise">
<p><span id="exr:unlabeled-div-14" class="exercise"><strong>Exercise 18.1  </strong></span>For these exercises you will need the <code>Brexit</code> data frame created in Section <a href="importing-combining-and-reshaping-data.html#exBrexit">12.10</a>.</p>
<ol style="list-style-type: decimal">
<li>Produce a scatter plot of the percentage voting to remain in the EU (within each local authority), against the percentage of adults with Level 4 qualifications.
<ul>
<li>Specify suitably descriptive axes labels;</li>
<li>add a linear trend to your plot;</li>
<li>colour each point by its <code>Region</code> variable.</li>
</ul></li>
<li>Produce a histogram showing the distribution of the percentage voting to remain in the EU across the different local authorities.
<ul>
<li>Specify a suitably descriptive axis label;</li>
<li>annotate your plot to indicate the vote in Sheffield.</li>
</ul></li>
<li>Produce a box plot for the percentage voting to remain in the EU within each region.
<ul>
<li>Experiment with ‘horizontal’ and ‘vertical’ box plots.</li>
</ul></li>
</ol>
</div>
</div>
</div>
<div id="further-reading-6" class="section level2 hasAnchor" number="18.8">
<h2><span class="header-section-number">18.8</span> Further reading<a href="making-plots-with-ggplot2.html#further-reading-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>There is an RStudio Cheatsheet on <code>ggplot2</code>: go to <strong>Help &gt; Cheatsheets &gt; Data Visualization with ggplot2</strong>.</p></li>
<li><p>The <a href="https://r-graphics.org/" target="_blank">R Graphics Cookbook (2nd edition)</a> is a good reference for making plots with <code>ggplot2</code>.</p></li>
<li><p>There is an online tutorial available here: <a href="https://rstudio.cloud/learn/primers/3">RStudio Primers (Visualize Data)</a></p></li>
<li><p>See also <a href="https://r4ds.had.co.nz/">R for Data Science (Chapter 3)</a></p></li>
</ul>

</div>
</div>
<h3>References<a href="references-1.html#references-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-R-ggrepel" class="csl-entry">
Slowikowski, Kamil. 2020. <em>Ggrepel: Automatically Position Non-Overlapping Text Labels with ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=ggrepel">https://CRAN.R-project.org/package=ggrepel</a>.
</div>
<div id="ref-ggplot22016" class="csl-entry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-R-ggplot2" class="csl-entry">
Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey Dunnington. 2020. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="missing-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="presentation-of-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
